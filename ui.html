<link rel="stylesheet" href="https://static.figma.com/api/figma-extension-api-0.0.1.css">
<style>
  body {
    background-color: #1C2039;
    font-weight: 600;
    color: #F6F7F9;
    margin: 37;
  }

  button {
    display: block;
    float: left;
    font-size: 20px;
    color: #F6F7F9;
    background-color: #383C59;
    width: 278px;
    height: 80px;
    margin-top: 15px;
    margin-right: 13px;
    border: none;
    border-radius: 10px;
    max-width: 300px;
    font-weight: 600;
    padding: 0 50px;
  }

  button:focus {
    border: 2px solid #EE454F;
    padding: 0 30px;
  }

  #BarButton, #TimeButton{
    margin-right: 0;
  }

  #PieButton {
    clear: both;
  }

  input {
    display: block;
    background-color: #383C59;
    width: 350px;
    height: 40px;
    padding-top: 14px;
    padding-bottom: 14px;
    border: 0;
    margin-top: 5px;
    border-radius: 25px;
    color:#f6f7f98a;
    padding-left: 30px;
    font-size: 19px;
    font-weight: 600;
    margin-left: -15px;
  }

  input:focus {
    background-color: #383C59;
    border: 2px solid #484CD3;
    outline: none;
    border-radius: 25px;
  }

  b {
    display: block;
    clear: both;
    width: 100%;
    font-size: 12px;
    margin-top: 10px;
    color: #EE454F;
  }

  #wartości {
    float: left;
    width: 360px;
    margin-left: 15px;
    font-size: 16px;
    color: #F6F7F9;
    margin-bottom: 5px;
    margin-right: 0px;
  }

  #logo {
    display: block;
    width: 125px;
    float: right;
  }

  #pomoc {
    margin-bottom: 80px;
    width: 25px;
    margin-left: -15px;
  }

  #instruction {
    font-size: 14px;
    margin-top: 20px;
    font-weight: normal;
  }

  p {
    display:inline;
    font-weight: bold;
  }


</style>

<div id="help" style="display: none; ">
  <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M11.9032 10.5L19.9594 2.44385C20.1531 2.25014 20.25 1.99576 20.25 1.74223C20.25 1.48869 20.1531 1.23436 19.9594 1.04064L19.9594 1.04062C19.5719 0.653138 18.9437 0.653117 18.5562 1.04062C18.5562 1.04062 18.5562 1.04063 18.5562 1.04063L10.5 9.09679L2.44381 1.04062C2.05632 0.653135 1.42807 0.653118 1.04061 1.04063C0.653187 1.4281 0.653102 2.05634 1.04063 2.44382L9.09685 10.5L1.04062 18.5562L1.2174 18.733L1.04062 18.5562C0.653133 18.9437 0.653117 19.5719 1.04063 19.9594C1.4281 20.3468 2.05633 20.3469 2.44381 19.9594C2.44381 19.9594 2.44382 19.9594 2.44382 19.9594L10.5 11.9032L18.5562 19.9594C18.9437 20.3469 19.572 20.3469 19.9594 19.9594C19.9594 19.9594 19.9594 19.9594 19.9594 19.9594L19.7826 19.7826L11.9032 10.5Z" fill="#F6F7F9" stroke="#F6F7F9" stroke-width="0.5"/>
</svg>
<div id="instruction">
  </br></br>
  <p>1. Wykres kołowy </p>- generuje wykres kołowy podzielony na wycinki, obrazujące proporcje. Pełne koło symbolizuje 100%. Wartości dowolne, np. 3, 5, 50. Wymagane minimum dwie wartości.
  </br></br>
  <p>2. Wykres kolumnowy</p> - wykres prezentujący dane za pomocą prostokątów. Domyślnymi etykietami są dni tygodnia, można edytować. Wartości dowolne, np. 3, 5, 50. Najlepiej wykres odczytuje się przy większej niż 1 liczbie wartości.
  </br></br>
  <p>3. Wykres kołowy procentowy</p> - generuje wykres na podstawie pierścienia, reprezentujący dane wartości procentowe. Wartości dowolne, np. 3, 5, 50 [%]. Maksymalnie cztery wartości.
  </br></br>
  <p>4. Wykres natężenia czasu</p> - generuje tablicę zbudowaną z prostokątów różnego koloru. Im ciemniejszy kolor, tym więcej razy dana czynność była wtedy wykonywana. Wartości generowane losowo. Dwie dane wejściowe, np. 12, 4, reprezentujące wymiary tablicy. 
</div></div>

<div id="wartości">
  <div id="pomoc"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M13.1999 16.8003H10.7999V19.2003H13.1999V16.8003Z" fill="#F6F7F9"/>
    <path d="M12 0C5.3726 0 0 5.3726 0 12C0 18.6273 5.3726 23.9999 12 23.9999C18.6273 23.9999 23.9999 18.6273 23.9999 12C23.9999 5.3726 18.6274 0 12 0ZM12 21.828C6.57213 21.828 2.17198 17.4278 2.17198 12C2.17198 6.57213 6.57213 2.17198 12 2.17198C17.4251 2.17856 21.8213 6.57483 21.828 12C21.828 17.4279 17.4279 21.828 12 21.828Z" fill="#F6F7F9"/>
    <path d="M16.668 8.46023C16.0507 5.88212 13.4603 4.29261 10.8822 4.9099C8.71476 5.42886 7.18965 7.37151 7.2 9.60025H9.60002C9.71269 8.27477 10.8785 7.29158 12.204 7.40425C13.5295 7.51692 14.5127 8.68275 14.4 10.0082C14.1549 11.201 13.0849 12.0427 11.868 12.0002C11.2782 12.0002 10.8 12.4784 10.8 13.0682V15.6002H13.2V14.2322C15.738 13.5777 17.2818 11.0084 16.668 8.46023Z" fill="#F6F7F9"/>
</svg></div>
  Podaj wartości:<input id="textbox" placeholder="1, 2, 3, ..." value="1, 2, 3, 4">
</div>
<div id="logo">
  <svg version="1.1" id="Warstwa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 136 180" style="enable-background:new 0 0 136 180;" xml:space="preserve">
  <style type="text/css">
    .st0{fill:#F6F7F9;}
  </style>
  <path class="st0" d="M119.1,20.6l-28.9,29h0L67,72.8L43.8,49.6h0l-8.5-8.5c-5.2-5.2-5.2-13.4,0-18.6c5.2-5.2,13.4-5.2,18.6,0
    L67,35.6v0L100.5,2C89.2-2.2,76.1,0.2,67,9.4v0C54.6-3,34.5-3,22.2,9.4c-11,11-12.2,27.9-3.8,40.2h0c1.1,1.5,2.3,3,3.8,4.6L67,99
    l44.8-44.8c1.4-1.4,2.7-2.9,3.8-4.6h0C121.5,40.9,122.6,30.1,119.1,20.6z"/>
  <path class="st0" d="M0.7,155h17.5c4.6,0,8-1.1,10.4-3.2c2.4-2.2,3.6-5,3.6-8.5c0-2.8-0.8-5.1-2.2-7c-1.5-1.9-3.6-3.1-6.4-3.8v-0.1
    c2.2-0.8,3.8-2.1,4.9-3.8c1-1.7,1.6-3.6,1.6-5.7c0-3.4-1.2-5.9-3.6-7.7c-2.4-1.7-5.9-2.6-10.4-2.6H0.7V155z M9.1,129.8v-10h6
    c4.3,0,6.5,1.7,6.5,5c0,3.4-2,5-6.1,5H9.1z M9.1,147.6v-10.9h7.1c2.4,0,4.2,0.5,5.5,1.5c1.2,1,1.9,2.3,1.9,4c0,1.8-0.6,3.1-1.7,4
    c-1.1,1-2.7,1.4-4.7,1.4H9.1z"/>
  <path class="st0" d="M48.8,155.5c3.5,0,6.4-1.3,8.6-4.1l0.1,0.1v3.5h7.9v-29.3h-7.9v14.3c0,2.7-0.7,4.8-1.9,6.3
    c-1.3,1.5-2.8,2.2-4.6,2.2c-1.9,0-3.2-0.5-4.1-1.6c-0.8-1.1-1.2-2.9-1.2-5.6v-15.7H38v17.7C38,151.5,41.6,155.5,48.8,155.5z"/>
  <path class="st0" d="M73,155h7.9v-14.6c0-2.5,0.5-4.5,1.7-5.9s2.6-2.2,4.5-2.2c3.4,0,5.2,2.6,5.2,7.6V155h7.9v-14.6
    c0-2.5,0.5-4.5,1.7-5.9s2.6-2.2,4.3-2.2c3.4,0,5.1,2.6,5.1,7.6V155h7.9v-17c0-8.5-3.5-12.8-10.3-12.8c-4.4,0-7.9,1.6-10.3,4.6h-0.1
    c-1.7-3.1-4.6-4.6-8.6-4.6c-3.5,0-6.4,1.4-8.8,4.3h-0.1v-3.8H73V155z"/>
  <path class="st0" d="M130.8,121.7c1.4,0,2.6-0.4,3.5-1.4c1-1,1.4-2.1,1.4-3.5c0-1.3-0.5-2.4-1.4-3.4c-1-1-2.2-1.4-3.5-1.4
    c-1.4,0-2.6,0.5-3.6,1.4c-1,1-1.4,2-1.4,3.4c0,1.4,0.4,2.5,1.4,3.5C128.1,121.3,129.3,121.7,130.8,121.7z M126.8,155h7.9v-29.3h-7.9
    V155z"/>
  <path class="st0" d="M3.2,176h2.1v-2.1l1.1-1.2l1.9,3.3h2.4l-2.8-4.7l2.7-3.1H8.1l-2.8,3.3h0v-7.2H3.2V176z"/>
  <path class="st0" d="M11.8,176h2.1v-3.6c0-0.6,0.2-1.1,0.5-1.5s0.8-0.6,1.5-0.6c0.2,0,0.4,0,0.6,0v-2.3h-0.2c-1,0-1.7,0.4-2.4,1.2h0
    v-1.1h-2.1V176z"/>
  <path class="st0" d="M24.9,172c0-1.2-0.4-2.1-1.1-2.8c-0.7-0.7-1.6-1.1-2.7-1.1c-1.2,0-2.1,0.4-2.9,1.1c-0.7,0.8-1.1,1.7-1.1,2.9
    c0,1.2,0.4,2.2,1.1,2.9c0.8,0.8,1.7,1.1,3,1.1c1.5,0,2.6-0.5,3.4-1.5l-1.4-1.3c-0.5,0.6-1.1,0.9-1.9,0.9c-0.5,0-1-0.1-1.3-0.4
    c-0.4-0.3-0.6-0.6-0.7-1.1h5.5C24.8,172.5,24.9,172.3,24.9,172z M21.1,169.9c0.9,0,1.4,0.5,1.7,1.4h-3.4c0.1-0.4,0.3-0.8,0.6-1
    C20.3,170,20.7,169.9,21.1,169.9z"/>
  <path class="st0" d="M29.8,176.1c1,0,1.8-0.4,2.4-1.1l0,0v0.9h2v-7.8H32v0.9l0,0c-0.6-0.7-1.3-1-2.3-1c-1.1,0-1.9,0.4-2.6,1.2
    c-0.7,0.8-1,1.7-1,2.9c0,1.2,0.3,2.2,1,2.9C27.8,175.8,28.7,176.1,29.8,176.1z M30.2,174.3c-0.6,0-1.1-0.2-1.4-0.6
    c-0.4-0.4-0.6-0.9-0.6-1.5c0-0.7,0.2-1.2,0.6-1.6c0.4-0.4,0.9-0.6,1.4-0.6c0.6,0,1,0.2,1.4,0.6c0.4,0.4,0.6,0.9,0.6,1.6
    c0,0.6-0.2,1.2-0.6,1.5C31.2,174.1,30.7,174.3,30.2,174.3z"/>
  <path class="st0" d="M38.5,176.1c0.8,0,1.5-0.2,2.1-0.5l-0.5-1.7c-0.4,0.2-0.7,0.3-1,0.3c-0.3,0-0.4-0.1-0.5-0.2s-0.1-0.4-0.1-0.8
    v-3.3h2.1v-1.7h-2.1v-2.8l-2.1,0.2v2.5h-0.9v1.7h0.9v3.6c0,0.9,0.2,1.5,0.6,2C37.3,175.9,37.8,176.1,38.5,176.1z"/>
  <path class="st0" d="M45.4,176.1c1.2,0,2.2-0.4,3-1.1c0.8-0.8,1.2-1.7,1.2-2.9c0-1.2-0.4-2.2-1.2-2.9c-0.8-0.7-1.8-1.1-3-1.1
    c-1.2,0-2.2,0.4-3,1.1c-0.8,0.8-1.2,1.7-1.2,2.9c0,1.2,0.4,2.2,1.2,2.9C43.1,175.8,44.1,176.1,45.4,176.1z M45.4,174.3
    c-0.6,0-1.1-0.2-1.5-0.6s-0.6-0.9-0.6-1.6c0-0.6,0.2-1.1,0.6-1.5s0.9-0.6,1.5-0.6c0.6,0,1.1,0.2,1.4,0.6c0.4,0.4,0.6,0.9,0.6,1.6
    s-0.2,1.2-0.6,1.6C46.4,174.1,45.9,174.3,45.4,174.3z"/>
  <path class="st0" d="M51.2,176h2.1v-3.6c0-0.6,0.2-1.1,0.5-1.5c0.4-0.4,0.8-0.6,1.5-0.6c0.2,0,0.4,0,0.6,0v-2.3h-0.2
    c-1,0-1.7,0.4-2.4,1.2h0v-1.1h-2.1V176z"/>
  <path class="st0" d="M63.1,176h1.8l1.4-4.8h0l1.4,4.8h1.8l2.7-7.8h-2.1l-1.5,4.8h0l-1.4-4.8h-1.7l-1.4,4.8h0l-1.5-4.8h-2.1L63.1,176
    z"/>
  <path class="st0" d="M74.5,179.2h2.1l4.2-11h-2.1l-1.8,4.8h0l-1.9-4.8h-2.2l3.1,7.3L74.5,179.2z"/>
  <path class="st0" d="M82.1,176h2.1v-2.1l1.1-1.2l1.9,3.3h2.4l-2.8-4.7l2.7-3.1H87l-2.8,3.3h0v-7.2h-2.1V176z"/>
  <path class="st0" d="M90.7,176h2.1v-3.6c0-0.6,0.2-1.1,0.5-1.5c0.4-0.4,0.8-0.6,1.5-0.6c0.2,0,0.4,0,0.6,0v-2.3h-0.2
    c-1,0-1.7,0.4-2.4,1.2h0v-1.1h-2.1V176z"/>
  <path class="st0" d="M103.7,172c0-1.2-0.4-2.1-1.1-2.8c-0.7-0.7-1.6-1.1-2.7-1.1c-1.2,0-2.1,0.4-2.9,1.1c-0.7,0.8-1.1,1.7-1.1,2.9
    c0,1.2,0.4,2.2,1.1,2.9c0.8,0.8,1.7,1.1,3,1.1c1.5,0,2.6-0.5,3.4-1.5l-1.4-1.3c-0.5,0.6-1.1,0.9-1.9,0.9c-0.5,0-1-0.1-1.3-0.4
    c-0.4-0.3-0.6-0.6-0.7-1.1h5.5C103.7,172.5,103.7,172.3,103.7,172z M100,169.9c0.9,0,1.4,0.5,1.7,1.4h-3.4c0.1-0.4,0.3-0.8,0.6-1
    C99.2,170,99.5,169.9,100,169.9z"/>
  <path class="st0" d="M107.9,176.1c1,0,1.7-0.2,2.2-0.7c0.5-0.4,0.8-1,0.8-1.8c0-0.3,0-0.6-0.1-0.8s-0.2-0.4-0.3-0.6
    c-0.1-0.1-0.3-0.3-0.6-0.4c-0.3-0.2-0.5-0.3-0.7-0.4c-0.2-0.1-0.5-0.2-0.9-0.4c-0.8-0.3-1.2-0.6-1.2-0.8c0-0.2,0.1-0.3,0.2-0.4
    c0.1-0.1,0.3-0.1,0.5-0.1c0.7,0,1.3,0.3,1.9,0.8l1-1.6c-0.8-0.6-1.8-1-2.8-1c-0.8,0-1.5,0.2-2,0.6c-0.5,0.4-0.8,1-0.8,1.7
    c0,0.7,0.2,1.2,0.6,1.6s1,0.7,1.8,0.9c0.5,0.2,0.9,0.3,1.1,0.4c0.2,0.1,0.3,0.2,0.3,0.4c0,0.2-0.1,0.4-0.3,0.5
    c-0.2,0.1-0.4,0.2-0.7,0.2c-0.8,0-1.5-0.3-2.2-0.9l-1,1.5C105.6,175.8,106.6,176.1,107.9,176.1z"/>
  <path class="st0" d="M115.1,167.1h2l2-2.4l-2.2,0L115.1,167.1z M116.2,176.1c1.2,0,2.2-0.4,3-1.1s1.2-1.7,1.2-2.9
    c0-1.2-0.4-2.2-1.2-2.9c-0.8-0.7-1.8-1.1-3-1.1c-1.2,0-2.2,0.4-3,1.1c-0.8,0.8-1.2,1.7-1.2,2.9c0,1.2,0.4,2.2,1.2,2.9
    C113.9,175.8,114.9,176.1,116.2,176.1z M116.2,174.3c-0.6,0-1.1-0.2-1.5-0.6c-0.4-0.4-0.6-0.9-0.6-1.6c0-0.6,0.2-1.1,0.6-1.5
    c0.4-0.4,0.9-0.6,1.5-0.6c0.6,0,1.1,0.2,1.4,0.6c0.4,0.4,0.6,0.9,0.6,1.6s-0.2,1.2-0.6,1.6C117.2,174.1,116.8,174.3,116.2,174.3z"/>
  <path class="st0" d="M123.4,176h1.8l1.4-4.8h0l1.4,4.8h1.8l2.7-7.8h-2.1l-1.5,4.8h0l-1.4-4.8h-1.7l-1.4,4.8h0l-1.5-4.8h-2.1
    L123.4,176z"/>
  </svg>
</div>

<b id="errors"></b>
  <button id='PieButton'>Wykres kołowy</button>
  <button id='BarButton'>Wykres kolumnowy</button>
  <button id='CircleButton'>Wykres kołowy procentowy</button>
  <button id='TimeButton'>Wykres natężenia czasu</button>


<script>
  document.getElementById('PieButton').onclick = () => {
    const text = document.querySelector('#textbox').value;

    let numbers = text.split(',').map(x => +x)
    if (numbers.length < 2) {
      showError('Error: Muszą być wpisane minimum 2 wartości');
      return
    }
    if (numbers.some(x => isNaN(x))) {
      showError('Error: Wszystkie wartości muszą być liczbami');
      return
    }

    parent.postMessage({ pluginMessage: { type: 'pie', numbers } }, '*')
  }

  document.getElementById('BarButton').onclick = () => {
    const text = document.querySelector('#textbox').value;
    let numbers = text.split(',').map(x => +x)
    
    if (numbers.some(x => isNaN(x))) {
      showError('Error: Wszystkie wartości muszą być liczbami');
      return
    }

    parent.postMessage({ pluginMessage: { type: 'bar', numbers } }, '*')
  }

  document.getElementById('CircleButton').onclick = () => {
    const text = document.querySelector('#textbox').value;
    let numbers = text.split(',').map(x => +x)

    if (numbers.length < 1) {
      showError('Error: Muszą być wpisane minimum 1 wartość');
      return
    }

    if (numbers.length > 4) {
      showError('Error: Mogą być wpisane maximum 4 wartości');
      return
    }
    let numbers2 = (numbers).map(x => Math.max(0, x));
    const total = numbers2.reduce((a, b) => a + b, 0);

    if (total > 100) {
      showError('Error: Suma wartości % musi być mniejsza niż 100');
      return
    }

    if (numbers.some(x => isNaN(x))) {
      showError('Error: Wszystkie wartości muszą być liczbami');
      return
    }

    parent.postMessage({ pluginMessage: { type: 'circle', numbers } }, '*')
  }

  document.getElementById('TimeButton').onclick = () => {
    const text = document.querySelector('#textbox').value;
    let numbers = text.split(',').map(x => +x)

    if (numbers.length != 2) {
      showError('Error: Muszą być wpisane 2 wartości');
      return
    }

    if (numbers.some(x => isNaN(x))) {
      showError('Error: Wszystkie wartości muszą być liczbami');
      return
    }

    parent.postMessage({ pluginMessage: { type: 'time', numbers } }, '*')
  }

  document.getElementById('pomoc').onclick = () => {
    var wartosciElem = document.getElementById("wartości");
    var logoElem = document.getElementById("logo");
    var errorsElem = document.getElementById("errors");
    var button1Elem = document.getElementById("PieButton");
    var button2Elem = document.getElementById("BarButton");
    var button3Elem = document.getElementById("CircleButton");
    var button4Elem = document.getElementById("TimeButton");

    wartosciElem.style.display = "none";
    logoElem.style.display = "none";
    errorsElem.style.display = "none";
    button1Elem.style.display = "none";
    button2Elem.style.display = "none";
    button3Elem.style.display = "none";
    button4Elem.style.display = "none";

    var helpElem = document.getElementById("help");
    helpElem.style.display = "block";
  }

  document.getElementById('help').onclick = () => {
    var wartosciElem = document.getElementById("wartości");
    var logoElem = document.getElementById("logo");
    var errorsElem = document.getElementById("errors");
    var button1Elem = document.getElementById("PieButton");
    var button2Elem = document.getElementById("BarButton");
    var button3Elem = document.getElementById("CircleButton");
    var button4Elem = document.getElementById("TimeButton");

    wartosciElem.style.display = "block";
    logoElem.style.display = "block";
    errorsElem.style.display = "block";
    button1Elem.style.display = "block";
    button2Elem.style.display = "block";
    button3Elem.style.display = "block";
    button4Elem.style.display = "block";

    var helpElem = document.getElementById("help");
    helpElem.style.display = "none";
  }

  showError = errorMessage => {
    document.querySelector('#errors').textContent = errorMessage
  }
  
</script>